---
title: "[MMP] 基本概念"
date: 2017-08-11 13:07:39
categories: [学习笔记, MMP]  
tags: MMP
description: 基本概念和名词解释
---
# 多进程多线程比较  
## 定义
一个程序至少有一个进程,一个进程至少有一个线程
线程是进程的一部分，所以线程有的时候被称为是轻权进程或者轻量级进程。
线程是进程的一个实体,是CPU调度和分派的基本单位

## 多进程  
相互隔离（独立地址空间，稳定），资源多（很容易扩充性能）
开销大（切换、创建和销毁，有足够处理器切换就不是问题，不频繁创建销毁就没有这个问题），内存不共享（通信麻烦）

## 多线程  
开销小（上下文切换、创建和销毁），共享数据（不需要特殊通信机制，同步数据时更快）
弱稳定性（一个线程出错可能导致整个进程结束），资源少（能够提高的总性能有限），同步麻烦

## 总结
当不同任务间需要大量共享数据或同步通信时优先多线程，其余用多进程。
**提升效率一般做法**
池、减少同步和通信、合理安排共享数据结构、无锁、避免缺页、避免使用可能产生可伸缩性问题的系统调用、用协程代替线程。  

# 名词
## 并发并行
两件事在相同时间间隔发生为并发，两个任务在相同时间间隔执行为并发执行。注意在这个同一间隔的不同部分执行的任务也可以称作并发，间隔长度不限（小时为单位也行）。  
这里指多线程被调度到多个核心执行，这在间隔时间内是并发的；以前的单核多线程是串行执行。  
一说并发是指一次做很多事情，但是会争用资源，并行是相互之间互不干扰。

## Tls
线程局部存储（Thread Local Storage），只有全局变量和函数局部变量可以声明成tls。
## 线程优先级
高优先级的线程有更多执行机会。但是在多处理器系统中，不同优先级的线程可以在各自的处理器同时运行。  
**优先级反转**
低优先级线程拥有的一项资源阻塞了高优先级线程运行。  
## 超额认购（申请）
通常程序中设置的线程数量正比与处理器数量。
对于计算量相当大的操作，超额申请通常不会带来优势，因为它引入了额外的系统开销。
但是，**对于延迟时间很长的任务（如IO、被互斥量阻塞），超额申请可以提高某些应用程序的总体效率**。
